<ResourceDictionary
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="clr-namespace:PF.UI.Resources"
    xmlns:pfcontrol="clr-namespace:PF.UI.Controls;assembly=PF.UI.Controls">
   
    <ControlTemplate x:Key="ChatBubbleStringBaseTemplate" TargetType="pfcontrol:ChatBubble">
        <pfcontrol:SimplePanel>
            <Path
                Name="Tail"
                Width="15"
                Height="15"
                HorizontalAlignment="Right"
                VerticalAlignment="Bottom"
                Data="{StaticResource BubbleTailGeometry}"
                Fill="{TemplateBinding Background}"
                RenderTransformOrigin="0.5,0.5"
                Stretch="Uniform" />
            <Border
                Name="Body"
                Margin="0,0,3,0"
                Background="{TemplateBinding Background}"
                CornerRadius="15">
                <TextBlock
                    Margin="{TemplateBinding Padding}"
                    VerticalAlignment="Center"
                    Text="{TemplateBinding Content}"
                    TextWrapping="Wrap" />
            </Border>
        </pfcontrol:SimplePanel>
        <ControlTemplate.Triggers>
            <Trigger Property="Role" Value="Receiver">
                <Setter TargetName="Tail" Property="HorizontalAlignment" Value="Left" />
                <Setter TargetName="Tail" Property="RenderTransform">
                    <Setter.Value>
                        <TransformGroup>
                            <ScaleTransform ScaleX="-1" ScaleY="1" />
                        </TransformGroup>
                    </Setter.Value>
                </Setter>
                <Setter TargetName="Body" Property="Margin" Value="3,0,0,0" />
            </Trigger>
        </ControlTemplate.Triggers>
    </ControlTemplate>

    <ControlTemplate x:Key="ChatBubbleImageBaseTemplate" TargetType="pfcontrol:ChatBubble">
        <pfcontrol:SimplePanel>
            <Path
                Name="Tail"
                Width="15"
                Height="15"
                HorizontalAlignment="Right"
                VerticalAlignment="Bottom"
                Data="{StaticResource BubbleTailGeometry}"
                Fill="{TemplateBinding Background}"
                RenderTransformOrigin="0.5,0.5"
                Stretch="Uniform" />
            <Border
                Name="Body"
                Margin="0,0,3,0"
                Background="{TemplateBinding Background}"
                CornerRadius="15">
                <pfcontrol:SimplePanel>
                    <Image
                        Margin="{TemplateBinding Padding}"
                        VerticalAlignment="Center"
                        Source="{TemplateBinding Content}" />
                    <Border
                        Background="{x:Null}"
                        BorderBrush="{TemplateBinding Background}"
                        BorderThickness="{TemplateBinding Padding}"
                        CornerRadius="15" />
                </pfcontrol:SimplePanel>
            </Border>
        </pfcontrol:SimplePanel>
        <ControlTemplate.Triggers>
            <Trigger Property="Role" Value="Receiver">
                <Setter TargetName="Tail" Property="HorizontalAlignment" Value="Left" />
                <Setter TargetName="Tail" Property="RenderTransform">
                    <Setter.Value>
                        <TransformGroup>
                            <ScaleTransform ScaleX="-1" ScaleY="1" />
                        </TransformGroup>
                    </Setter.Value>
                </Setter>
                <Setter TargetName="Body" Property="Margin" Value="3,0,0,0" />
            </Trigger>
        </ControlTemplate.Triggers>
    </ControlTemplate>

    <ControlTemplate x:Key="ChatBubbleAudioBaseTemplate" TargetType="pfcontrol:ChatBubble">
        <Grid>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Name="Definition1" Width="12" />
                <ColumnDefinition Name="Definition2" />
            </Grid.ColumnDefinitions>
            <Ellipse
                Name="Dot"
                Width="6"
                Height="6"
                Margin="0,0,6,0"
                VerticalAlignment="Top"
                Fill="{DynamicResource DangerBrush}"
                Visibility="{TemplateBinding IsRead,
                                             Converter={StaticResource Boolean2VisibilityReConverter}}" />
            <Path
                Name="Tail"
                Grid.Column="1"
                Width="15"
                Height="15"
                HorizontalAlignment="Right"
                VerticalAlignment="Bottom"
                Data="{StaticResource BubbleTailGeometry}"
                Fill="{TemplateBinding Background}"
                RenderTransformOrigin="0.5,0.5"
                Stretch="Uniform" />
            <Border
                Name="Body"
                Grid.Column="1"
                Margin="0,0,3,0"
                Background="{TemplateBinding Background}"
                CornerRadius="15">
                <Grid Margin="{TemplateBinding Padding}" VerticalAlignment="Center">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition Width="Auto" />
                    </Grid.ColumnDefinitions>
                    <ContentPresenter Name="Presenter" VerticalAlignment="Center" />
                    <Path
                        Name="Audio"
                        Grid.Column="1"
                        Width="16"
                        Height="16"
                        Margin="6,0,0,0"
                        Data="{StaticResource AudioGeometry}"
                        Fill="{TemplateBinding Foreground}"
                        RenderTransformOrigin="0.5,0.5">
                        <Path.RenderTransform>
                            <TransformGroup>
                                <ScaleTransform ScaleX="-1" ScaleY="1" />
                            </TransformGroup>
                        </Path.RenderTransform>
                    </Path>
                </Grid>
            </Border>
        </Grid>
        <ControlTemplate.Triggers>
            <Trigger Property="Role" Value="Receiver">
                <Setter TargetName="Tail" Property="HorizontalAlignment" Value="Left" />
                <Setter TargetName="Tail" Property="RenderTransform">
                    <Setter.Value>
                        <TransformGroup>
                            <ScaleTransform ScaleX="-1" ScaleY="1" />
                        </TransformGroup>
                    </Setter.Value>
                </Setter>
                <Setter TargetName="Tail" Property="Grid.Column" Value="0" />
                <Setter TargetName="Dot" Property="Grid.Column" Value="1" />
                <Setter TargetName="Dot" Property="Margin" Value="6,0,0,0" />
                <Setter TargetName="Body" Property="Margin" Value="3,0,0,0" />
                <Setter TargetName="Body" Property="Grid.Column" Value="0" />
                <Setter TargetName="Definition1" Property="Width" Value="Auto" />
                <Setter TargetName="Definition2" Property="Width" Value="12" />
                <Setter TargetName="Audio" Property="Grid.Column" Value="0" />
                <Setter TargetName="Audio" Property="Margin" Value="0,0,6,0" />
                <Setter TargetName="Audio" Property="RenderTransform">
                    <Setter.Value>
                        <TransformGroup>
                            <ScaleTransform ScaleX="1" ScaleY="1" />
                        </TransformGroup>
                    </Setter.Value>
                </Setter>
                <Setter TargetName="Presenter" Property="Grid.Column" Value="1" />
            </Trigger>
        </ControlTemplate.Triggers>
    </ControlTemplate>

    <ControlTemplate x:Key="ChatBubbleCustomBaseTemplate" TargetType="pfcontrol:ChatBubble">
        <pfcontrol:SimplePanel>
            <Path
                Name="Tail"
                Width="15"
                Height="15"
                HorizontalAlignment="Right"
                VerticalAlignment="Bottom"
                Data="{StaticResource BubbleTailGeometry}"
                Fill="{TemplateBinding Background}"
                RenderTransformOrigin="0.5,0.5"
                Stretch="Uniform" />
            <Border
                Name="Body"
                Margin="0,0,3,0"
                Background="{TemplateBinding Background}"
                CornerRadius="15">
                <ContentPresenter Margin="{TemplateBinding Padding}" VerticalAlignment="Center" />
            </Border>
        </pfcontrol:SimplePanel>
        <ControlTemplate.Triggers>
            <Trigger Property="Role" Value="Receiver">
                <Setter TargetName="Tail" Property="HorizontalAlignment" Value="Left" />
                <Setter TargetName="Tail" Property="RenderTransform">
                    <Setter.Value>
                        <TransformGroup>
                            <ScaleTransform ScaleX="-1" ScaleY="1" />
                        </TransformGroup>
                    </Setter.Value>
                </Setter>
                <Setter TargetName="Body" Property="Margin" Value="3,0,0,0" />
            </Trigger>
        </ControlTemplate.Triggers>
    </ControlTemplate>

    <Style x:Key="ChatBubbleBaseStyle" TargetType="pfcontrol:ChatBubble">
        <Setter Property="Focusable" Value="False" />
        <Setter Property="HorizontalAlignment" Value="Right" />
        <Setter Property="Background" Value="{DynamicResource DarkPrimaryBrush}" />
        <Setter Property="Foreground" Value="{DynamicResource TextIconBrush}" />
        <Setter Property="Padding" Value="10" />
        <Setter Property="Margin" Value="10" />
        <Setter Property="MinHeight" Value="{StaticResource DefaultControlHeight}" />
        <Setter Property="Template" Value="{StaticResource ChatBubbleStringBaseTemplate}" />
        <Setter Property="IsRead" Value="{Binding IsSelected, RelativeSource={RelativeSource Self}}" />
        <Setter Property="MaxWidth" Value="280" />
        <Style.Triggers>
            <Trigger Property="Role" Value="Receiver">
                <Setter Property="Background" Value="{DynamicResource BorderBrush}" />
                <Setter Property="Foreground" Value="{DynamicResource PrimaryTextBrush}" />
                <Setter Property="HorizontalAlignment" Value="Left" />
            </Trigger>
            <Trigger Property="Type" Value="Image">
                <Setter Property="Template" Value="{StaticResource ChatBubbleImageBaseTemplate}" />
                <Setter Property="MaxHeight" Value="280" />
            </Trigger>
            <Trigger Property="Type" Value="Audio">
                <Setter Property="Template" Value="{StaticResource ChatBubbleAudioBaseTemplate}" />
            </Trigger>
            <Trigger Property="Type" Value="Custom">
                <Setter Property="Template" Value="{StaticResource ChatBubbleCustomBaseTemplate}" />
            </Trigger>
        </Style.Triggers>
    </Style>

</ResourceDictionary>
