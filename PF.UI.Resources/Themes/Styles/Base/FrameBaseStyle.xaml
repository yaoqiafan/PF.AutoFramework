<ResourceDictionary
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="clr-namespace:PF.UI.Resources"
    xmlns:pfcontrol="clr-namespace:PF.UI.Controls;assembly=PF.UI.Controls">
   
    <Style
        x:Key="MenuItem4FrameStyle"
        BasedOn="{StaticResource MenuItemBaseStyle}"
        TargetType="MenuItem">
        <Setter Property="Header" Value="{Binding (JournalEntry.Name)}" />
        <Setter Property="Command" Value="NavigationCommands.NavigateJournal" />
        <Setter Property="CommandTarget" Value="{Binding TemplatedParent, RelativeSource={RelativeSource AncestorType=ContextMenu}}" />
        <Setter Property="CommandParameter" Value="{Binding RelativeSource={RelativeSource Self}}" />
    </Style>

    <ControlTemplate x:Key="FrameWithNavigationUIStyle" TargetType="Frame">
        <Border
            Background="{TemplateBinding Background}"
            BorderBrush="{TemplateBinding BorderBrush}"
            BorderThickness="{TemplateBinding BorderThickness}"
            CornerRadius="{Binding Path=(pfcontrol:BorderElement.CornerRadius), RelativeSource={RelativeSource TemplatedParent}}">
            <DockPanel LastChildFill="True">
                <Border
                    Background="{DynamicResource DarkDefaultBrush}"
                    BorderBrush="{TemplateBinding BorderBrush}"
                    BorderThickness="0,0,0,1"
                    CornerRadius="{Binding Path=(pfcontrol:BorderElement.CornerRadius), RelativeSource={RelativeSource TemplatedParent}, Converter={StaticResource CornerRadiusSplitConverter}, ConverterParameter='1,1,0,0'}"
                    DockPanel.Dock="Top">
                    <pfcontrol:ButtonGroup
                        x:Name="NavChrome"
                        Width="90"
                        Margin="10,6"
                        HorizontalAlignment="Left">
                        <Button
                            Padding="6"
                            pfcontrol:IconElement.Geometry="{StaticResource LeftGeometry}"
                            Command="NavigationCommands.BrowseBack">
                            <Button.ContextMenu>
                                <ContextMenu
                                    x:Name="BackNavMenu"
                                    ItemContainerStyle="{StaticResource MenuItem4FrameStyle}"
                                    ItemsSource="{Binding Path=(NavigationWindow.BackStack), RelativeSource={RelativeSource TemplatedParent}}" />
                            </Button.ContextMenu>
                        </Button>
                        <Button
                            Padding="6"
                            pfcontrol:IconElement.Geometry="{StaticResource RightGeometry}"
                            Command="NavigationCommands.BrowseForward">
                            <Button.ContextMenu>
                                <ContextMenu
                                    x:Name="ForwardNavMenu"
                                    ItemContainerStyle="{StaticResource MenuItem4FrameStyle}"
                                    ItemsSource="{Binding Path=(NavigationWindow.ForwardStack), RelativeSource={RelativeSource TemplatedParent}}" />
                            </Button.ContextMenu>
                        </Button>
                        <Button
                            Padding="6"
                            pfcontrol:IconElement.Geometry="{StaticResource RotateRightGeometry}"
                            Command="NavigationCommands.Refresh" />
                    </pfcontrol:ButtonGroup>
                </Border>
                <ContentPresenter
                    x:Name="PART_NavWinCP"
                    ClipToBounds="true"
                    SnapsToDevicePixels="True" />
            </DockPanel>
        </Border>
    </ControlTemplate>

    <Style x:Key="FrameBaseStyle" TargetType="Frame">
        <Setter Property="pfcontrol:BorderElement.CornerRadius" Value="{StaticResource DefaultCornerRadius}" />
        <Setter Property="BorderThickness" Value="1" />
        <Setter Property="BorderBrush" Value="{DynamicResource BorderBrush}" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="Frame">
                    <Border
                        Background="{TemplateBinding Background}"
                        BorderBrush="{TemplateBinding BorderBrush}"
                        BorderThickness="{TemplateBinding BorderThickness}"
                        CornerRadius="{Binding Path=(pfcontrol:BorderElement.CornerRadius), RelativeSource={RelativeSource TemplatedParent}}">
                        <ContentPresenter x:Name="PART_FrameCP" SnapsToDevicePixels="True" />
                    </Border>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
        <Style.Triggers>
            <Trigger Property="NavigationUIVisibility" Value="Visible">
                <Setter Property="Template" Value="{StaticResource FrameWithNavigationUIStyle}" />
            </Trigger>
            <MultiTrigger>
                <MultiTrigger.Conditions>
                    <Condition Property="JournalOwnership" Value="OwnsJournal" />
                    <Condition Property="NavigationUIVisibility" Value="Automatic" />
                </MultiTrigger.Conditions>
                <Setter Property="Template" Value="{StaticResource FrameWithNavigationUIStyle}" />
            </MultiTrigger>
        </Style.Triggers>
    </Style>

</ResourceDictionary>
