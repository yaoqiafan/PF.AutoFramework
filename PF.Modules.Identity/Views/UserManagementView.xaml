<UserControl x:Class="PF.Modules.Identity.Views.UserManagementView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:prism="http://prismlibrary.com/"
             xmlns:attach="clr-namespace:PF.UI.Controls;assembly=PF.UI.Controls"
             prism:ViewModelLocator.AutoWireViewModel="True">
    <Grid Margin="15">
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="2*"/>
            <ColumnDefinition Width="15"/>
            <ColumnDefinition Width="1*"/>
        </Grid.ColumnDefinitions>

        <DockPanel Grid.Column="0">
            <StackPanel DockPanel.Dock="Top" Orientation="Horizontal" Margin="0,0,0,10">
                <Button Content="刷新列表" Command="{Binding RefreshCommand}" Margin="0,0,10,0" Padding="10,5"/>
                <Button Content="新增用户" Command="{Binding AddUserCommand}" Padding="10,5"/>
            </StackPanel>

            <DataGrid ItemsSource="{Binding Users}" SelectedItem="{Binding SelectedUser}" 
                      AutoGenerateColumns="False" IsReadOnly="True" CanUserAddRows="False"
                      BorderThickness="1" BorderBrush="#DDD">
                <DataGrid.Columns>
                    <DataGridTextColumn Header="用户名" Binding="{Binding UserName}" Width="*"/>
                    <DataGridTextColumn Header="角色等级" Binding="{Binding Root}" Width="100"/>
                    <DataGridTextColumn Header="ID" Binding="{Binding UserId}" Width="150" Visibility="Collapsed"/>
                </DataGrid.Columns>
            </DataGrid>
        </DockPanel>

        <Border Grid.Column="2" BorderBrush="#EEE" BorderThickness="1" Padding="15">
            <StackPanel IsEnabled="{Binding SelectedUser, Converter={StaticResource Object2BooleanConverter}}">
                <TextBlock Text="用户详情编辑" FontSize="16" FontWeight="Bold" Margin="0,0,0,15"/>

                <TextBlock Text="用户名：" Margin="0,5,0,2"/>
                <TextBox Text="{Binding SelectedUser.UserName, UpdateSourceTrigger=PropertyChanged}"/>

                <TextBlock Text="密码：" Margin="0,10,0,2"/>
                <TextBox Text="{Binding SelectedUser.Password, UpdateSourceTrigger=PropertyChanged}"/>

                <TextBlock Text="权限角色：" Margin="0,10,0,2"/>
                <ComboBox ItemsSource="{Binding UserLevels}" SelectedItem="{Binding SelectedUser.Root}"/>

                <Grid Margin="0,20,0,0">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>
                    <Button Grid.Column="0" Content="删除用户" Command="{Binding DeleteUserCommand}" Foreground="Red" Margin="0,0,5,0" Height="30"/>
                    <Button Grid.Column="1" Content="保存更改" Command="{Binding SaveUserCommand}" Margin="5,0,0,0" Height="30"/>
                </Grid>
            </StackPanel>
        </Border>
    </Grid>
</UserControl>